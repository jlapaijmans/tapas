# don't delete data if this file should be executed non-interactively
set -ueC

mkdir 02_out
cd 02_out


scd="../../scripts"
d_par="../../data/mut_tbl_par"
s_cross_tab="$scd/general/cross_tab.py"
s_index_column="$scd/general/index-column.py"
s_fill_template="$scd/general/fill_template.py"


# Generate all combinations of params factor, geom_prob, intercept
$s_cross_tab --head 1 $d_par/* | \
$s_index_column > combination_indices


# Output file template. This will be filled with the parameter combinations
# generated in the previous step 
cat >tmpl <<EOF
strand  from  to  factor   geom_prob   intercept 
3       A     G   {factor} {geom_prob} 0
5       C     T   {factor} {geom_prob} 0
3       *     *   0        0.1         {all_intercept}
EOF

# Convert tmpl to TAB-delimited file
sed -r 's/ +/\t/g' tmpl > tmpl.tmp && mv tmpl{.tmp,}

$s_fill_template --output "mut_{index}" tmpl < combination_indices

# vim: ft=sh

